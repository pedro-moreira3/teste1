<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">
	<ui:define name="content">
		<style>
.ui-autocomplete:not (.fixaAbaixo ) input {
	height: 100%;
}

.remove12ColPaddingSide div.ui-g-12.ui-lg-12 {
	padding-left: 0px;
	padding-right: 0px;
}

.dialogDados .ui-dialog-content {
	overflow: hidden;
}
</style>
		<div class="ui-g ui-fluid">
			<div class="ui-g-12 ui-lg-12">
				<div class="card card-w-title">

					<p:panelGrid columns="4" layout="grid" id="botoesLong"
						styleClass="ui-panelgrid-blank form-group ui-fluid optionsPaciente removeSideGridPadding">
						<p:commandButton id="new" icon="ui-icon-add"
							styleClass="BotaoCrud" actionListener="#{pacienteMB.actionNew}"
							update=":lume:pnPrincipalFicha, :lume:pnPrincipalFichaHeader, :lume:tabViewOutPanel, :lume:buttonsFichaPaciente"
							value="Novo" oncomplete="PF('dlgFichaPaciente').show()"
							process="@this" />

						<h:panelGroup>
							<p:splitButton icon="White fa fa fa-file-excel-o"
								value="Exportar tabela para Excel" styleClass="GreenSplitButton"
								actionListener="#{pacienteMB.exportarTabelaPaciente('xls')}"
								ajax="false" process="dtPrincipal,@this" update="@this"
								immediate="true"
								onclick="PrimeFaces.monitorDownload(function(){PF('loading').show();},function(){PF('loading').hide();});">

								<p:fileDownload value="#{pacienteMB.arquivoDownload}" />

								<p:menuitem value="Exportar tabela para PDF"
									icon="fa fa fa-file-pdf-o"
									actionListener="#{pacienteMB.exportarTabelaPaciente('pdf')}"
									ajax="false" process="dtPrincipal,@this" immediate="true"
									onclick="PrimeFaces.monitorDownload(function(){PF('loading').show();},function(){PF('loading').hide();});">
									<p:fileDownload value="#{pacienteMB.arquivoDownload}" />
								</p:menuitem>
								<p:menuitem value="Exportar tabela para CSV"
									icon="fa fa fa-file-pdf-o"
									actionListener="#{pacienteMB.exportarTabelaPaciente('csv')}"
									ajax="false" process="dtPrincipal,@this" immediate="true"
									onclick="PrimeFaces.monitorDownload(function(){PF('loading').show();},function(){PF('loading').hide();});">
									<p:fileDownload value="#{pacienteMB.arquivoDownload}" />
								</p:menuitem>
							</p:splitButton>
						</h:panelGroup>

					</p:panelGrid>

					<h:panelGroup id="botoes" styleClass="tableButtons">
						<p:commandButton icon="fa fa-file-excel-o" process="dtPrincipal"
							styleClass="BotaoCrud Exportar green-btn" ajax="false"
							id="btExporExcel" immediate="true">
							<p:dataExporter type="xls" target="dtPrincipal"
								fileName="pacientes" pageOnly="false" encoding="ISO-8859-1" />
							<p:tooltip value="Exportar tabela para Excel" for="btExporExcel" />
						</p:commandButton>
					</h:panelGroup>

					<p:dataTable filterDelay="1500" reflow="true" emptyMessage=""
						id="dtPrincipal" value="#{pacienteMB.entityList}" var="paciente"
						rows="7" paginator="true" rowKey="#{paciente}"
						paginatorPosition="bottom" widgetVar="dtPrincipal"
						binding="#{pacienteMB.tabelaPaciente}">

						<f:facet name="header">#{dominioMB.cliente}
							<h:panelGroup styleClass="pesquisa">
								<p:outputPanel>
									<h:outputText value="Pesquisar Paciente" />
									<p:inputText id="globalFilter"
										onkeyup="PF('dtPrincipal').filter()" style="width:150px" />
								</p:outputPanel>
							</h:panelGroup>
						</f:facet>

						<p:column headerText="Ações" width="100">
							<h:panelGroup rendered="#{paciente.status == 'A'}">
								<p:commandButton id="persistInativar"
									icon="White fa fa-chain-broken" title="Inativar"
									actionListener="#{pacienteMB.actionInativar(paciente)}"
									update=":lume:dtPrincipal" process="@this"
									styleClass="NavyButton" />
							</h:panelGroup>
							<h:panelGroup rendered="#{paciente.status == 'I'}">
								<p:commandButton id="persistAtivar"
									icon="White fa fa-chain White" title="Ativar"
									actionListener="#{pacienteMB.actionAtivar(paciente)}"
									update=":lume:dtPrincipal" process="@this"
									styleClass="NavyButton" />
							</h:panelGroup>
						</p:column>
						<p:column sortBy="#{paciente.dadosBasico.nome}"
							filterBy="#{paciente.dadosBasico.nomeStr}"
							filterMatchMode="contains" headerText="Nome"
							filterFunction="#{pacienteMB.filtroSemAcento}">
							<ui:remove>
								<p:commandLink value="#{paciente.dadosBasico.nome}"
									process="@this" title="#{paciente.id}"
									actionListener="#{tabPacienteMB.loadPaciente(paciente)}"
									oncomplete="PF('dlgDadosPaciente').show()"
									update=":lume:pnPrincipal" />
							</ui:remove>
							<p:commandLink value="#{paciente.dadosBasico.nome}"
								process="@this" title="#{paciente.id}"
								actionListener="#{tabPacienteMB.loadPaciente(paciente)}"
								oncomplete="PF('dlgFichaPaciente').show()"
								update=":lume:pnPrincipalFicha, :lume:pnPrincipalFichaHeader, :lume:tabViewOutPanel, :lume:buttonsFichaPaciente" />
						</p:column>
						<p:column sortBy="#{paciente.dadosBasico.email}"
							filterBy="#{paciente.dadosBasico.email}"
							filterMatchMode="contains" headerText="Email"
							rendered="#{pacienteMB.visivelDadosPaciente}"
							filterFunction="#{pacienteMB.filtroSemAcento}">
							<h:outputText value="#{paciente.dadosBasico.email}" />
						</p:column>
						<p:column sortBy="#{paciente.dadosBasico.dataNascimentoStrOrd}"
							filterBy="#{paciente.dadosBasico.dataNascimentoStr}"
							filterMatchMode="contains" headerText="Data de Nascimento">
							<h:outputText value="#{paciente.dadosBasico.dataNascimentoStr}" />
						</p:column>
						<p:column sortBy="#{paciente.dadosBasico.documentoStr}"
							filterBy="#{paciente.dadosBasico.documentoStr}"
							filterMatchMode="contains" headerText="Documento"
							rendered="#{pacienteMB.visivelDadosPaciente}">
							<h:outputText value="#{paciente.dadosBasico.documento}" />
						</p:column>
						<p:column sortBy="#{paciente.dadosBasico.celular}"
							filterBy="#{paciente.dadosBasico.celular}"
							filterMatchMode="contains" headerText="Telefone Celular"
							rendered="#{pacienteMB.visivelDadosPaciente}">
							<h:outputText value="#{paciente.dadosBasico.celular}" />
						</p:column>
					</p:dataTable>

					<p:panelGrid columns="4" layout="grid"
						styleClass="ui-panelgrid-blank form-group ui-fluid optionsPaciente removeSideGridPadding">
						<h:panelGroup rendered="#{pacienteMB.admin}">
							<p:commandButton value="Carregar Pacientes" process="@this"
								icon="White fa fa-upload" styleClass="OrangeButton"
								oncomplete="PF('dlgCarregarPacientes').show();" />
						</h:panelGroup>
					</p:panelGrid>
				</div>
			</div>
		</div>

<<<<<<< Upstream, based on origin/backend
		<ui:include src="pacienteFicha.xhtml" />
=======
		<p:remoteCommand name="updateButtons"
			update=":lume:buttonsDadosPaciente" />
		<p:dialog widgetVar="dlgDadosPaciente" resizable="false"
			onHide="PF('dlgDadosPaciente').toggleMaximize();"
			onShow="PF('dlgDadosPaciente').toggleMaximize();updateButtons()"
			appendTo=":lume" header="Cadastro de Paciente" responsive="true"
			modal="true" styleClass="dialogDados">
			<p:ajax event="close" resetValues="true" update=":lume:pnPrincipal" />
			<p:outputPanel id="pnPrincipal"
				style="max-height: calc(100% - 54px); height: calc(100% - 54px);">
				<p:scrollPanel mode="native" style="width: 100%; height: 100%;">
					<ui:include src="dadosPaciente.xhtml"></ui:include>
				</p:scrollPanel>
			</p:outputPanel>
			<p:panelGrid columns="4" layout="grid"
				styleClass="ui-panelgrid-blank form-group ui-fluid removeSideGridPadding">
				<p:commandButton id="salvar" icon="fa fa-check" value="Salvar"
					process="@this, :lume:pnPrincipal"
					update=":lume:pnPrincipal, :lume:dtPrincipal, :lume:view-log"
					styleClass="BotaoCrud GreenButton"
					actionListener="#{pacienteMB.actionPersist}"
					oncomplete="handleAjaxRequest(xhr, status, args); updateButtons()" />
				<h:panelGroup id="buttonsDadosPaciente">
					<p:commandButton styleClass="OrangeButton" icon="fa fa-file-text-o"
						process="@this" value="Exibir ficha do Paciente"
						actionListener="#{tabPacienteMB.openFicha}"
						disabled="#{pacienteMB.entity.id == null or pacienteMB.entity.id == 0}"
						update=":lume:pnPrincipalFichaHeader, :lume:pnPrincipalFicha, :lume:tabViewOutPanel">
					</p:commandButton>
				</h:panelGroup>
				<p:column />
				<p:commandButton icon="fa fa-close" value="Fechar" process="@this" update=":lume:pnPrincipal, :lume:dtPrincipal, :lume:view-log"
					oncomplete="PF('dlgDadosPaciente').hide()" actionListener="#{pacienteMB.fechar()}"/>
			</p:panelGrid>
		</p:dialog>

		<p:dialog widgetVar="dlgFichaPaciente" resizable="false"
			onHide="PF('dlgFichaPaciente').toggleMaximize();"
			onShow="PF('dlgFichaPaciente').toggleMaximize();" modal="true"
			appendTo=":lume">
			<f:facet name="header">
				<p:outputPanel id="pnPrincipalFichaHeader">
					<h:outputText
						value="Ficha do Paciente #{pacienteMB.entity.dadosBasico.nome}" />
				</p:outputPanel>
			</f:facet>
			<p:outputPanel id="pnPrincipalFicha"
				style="max-height: calc(100% - 54px); height: calc(100% - 54px);"
				styleClass="remove12ColPaddingSide">
				<p:scrollPanel mode="native"
					style="position: relative; width: 100%; height: 100%;">
					<p:outputPanel
						rendered="#{pacienteMB.entity.id != null and pacienteMB.entity.id != 0}">
						<ui:include src="dadosFichaPaciente.xhtml"></ui:include>
					</p:outputPanel>
				</p:scrollPanel>
			</p:outputPanel>
			<p:panelGrid columns="4" layout="grid"
				styleClass="ui-panelgrid-blank form-group ui-fluid removeSideGridPadding">
				<p:column />
				<p:column />
				<p:column />
				<p:commandButton icon="fa fa-close" value="Fechar" process="@this"
					oncomplete="PF('dlgFichaPaciente').hide()" />
			</p:panelGrid>
		</p:dialog>
>>>>>>> 2d50c2a anamnese e ortodontia

		<p:dialog id="dlgCarregarPacientes" header="Carregar Pacientes"
			widgetVar="dlgCarregarPacientes" responsive="true" modal="true"
			width="800" appendTo=":lume">
			<h:panelGroup id="pnCarregarPacientes">
				<div class="Container100 Responsive100 NoIndent">
					<div class="Container100 NoPadding">
						<div class="Container100 Responsive100">
							<div style="font-weight: bold;">Leiaute :</div>
							<br />
							nome;celular;dataNascimento[dd/MM/AAAA];email;cpf;rg;cep;endereco;numero[numérico];bairro;uf[ex:
							PR];telefone;sexo[M/F];cria usuário?[S/N];
						</div>
						<div class="Container100 Responsive100">
							<p:fileUpload fileUploadListener="#{pacienteMB.upload}"
								multiple="false" cancelLabel="Cancelar" uploadLabel="Carregar"
								mode="advanced" dragDropSupport="true" sizeLimit="500000000"
								label="Anexar"
								invalidFileMessage="Arquivo inválido para processamento."
								update=":lume:pnLogCarregarPacientes,:lume:dtPrincipal"
								onstart="PF('loading').show();"
								oncomplete="PF('loading').hide();"
								allowTypes="/(\.|\/)(csv|CSV|txt|TXT)$/" />
						</div>
						<div class="SeparatorFull"></div>
						<div class="Container100 Responsive100">
							<h:panelGroup id="pnLogCarregarPacientes">
								<p:dataList value="#{pacienteMB.errosCarregarPaciente}" var="e">
									<f:facet name="header">
                                		Erros
                            		</f:facet>
                            		#{e}
                        		</p:dataList>
							</h:panelGroup>
						</div>
					</div>
					<div class="SeparatorFull"></div>
					<div class="Container50 Responsive100">
						<p:commandButton icon="White fa fa-close" value="Fechar"
							process="@this" onclick="PF('dlgCarregarPacientes').hide()"
							styleClass="RedButton" />
					</div>
				</div>
			</h:panelGroup>
		</p:dialog>

	</ui:define>
</ui:composition>