<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jstl/core"
	template="/WEB-INF/template.xhtml"
	xmlns:pe="http://primefaces.org/ui/extensions">
	<ui:define name="content">
		<style>
.ui-growl {
	z-index: 999999 !important;
}

.ui-dialog {
	overflow: auto !important;
}

div.ui-selectoneradio label {
	width: auto !important;
}

.labelInlineParent {
	padding-top: 0px !important;
	padding-bottom: 20px !important;
}

.labelInline label {
	display: inline !important;
}

.ui-dialog {
	overflow: auto !important;
}

.fc-time-grid-container {
	height: auto !important;
}

.ui-growl {
	z-index: 999999 !important;
}

div.ui-selectoneradio label {
	width: auto !important;
}

.fc-time-grid-event>.fc-content {
	text-align: left !important;
}

.fc-toolbar {
	padding: 0 !important;
}

.fc .fc-left, .fc .fc-left .fc-button-group, .fc .fc-right .fc-button-group
	{
	display: inline-flex !important;
}

.fc .fc-right .fc-button-group button {
	width: 100px !important;
}

.filtroFirst .ui-panelgrid-cell {
	padding: 0px !important;
}

.filtroFirst .ui-panelgrid-cell:first-child {
	padding-right: 7px !important;
}

.filtroFirst .ui-panelgrid-cell:last-child {
	padding-left: 7px !important;
}

.removeSecondPadding>.ui-panelgrid-content .ui-grid-row .ui-panelgrid-cell:nth-child(1)
	{
	padding-top: 0px !important;
}

.ui-selectmanycheckbox tr td {
	position: relative;
	display: inline-flex !important;
	width: 238px !important
}

.ui-selectmanycheckbox tr td>div>div:last-child {
	display: inline-block;
	position: relative;
	top: 50%;
	transform: translateY(-50%);
}

.ui-selectmanycheckbox tr td label {
	position: relative;
	display: inline-flex !important;
}

.ui-selectmanycheckbox tr td label div:first-child {
	position: relative;
}

.ui-selectmanycheckbox tr td label div:first-child div {
	display: inline-block;
	position: relative;
	top: 50%;
	transform: translateY(-50%);
}

.NoChildPadding>div {
	padding: 0px !important;
}

.ui-fluid .ui-buttonset.ui-buttonset-3 .ui-button {
	width: 33.3% !important;
}

.ggl-tooltip {
	background-color: #ffffff;
	border: 1px solid #e0e0e0;
	font-family: Arial, Helvetica;
	font-size: 14px;
	padding: 8px;
}

.ggl-tooltip span {
	font-weight: bold;
}

.chartCadeiras>div, .chartProfissionais>div {
	max-width: 100%;
	overflow: auto;
	overflow-y: hidden;
}
</style>
		<div class="ui-g ui-fluid">
			<div class="ui-g-12 ui-lg-12">
				<div class="card card-w-title">
					<h1>Relatório de Atendimento</h1>

					<p:separator styleClass="SeparatorFull" />

					<p:fieldset id="filtroRelatorio" header="Filtro" toggleable="true"
						toggleSpeed="500">
						<p:outputPanel>
						<p:panelGrid columns="1" layout="grid"
							styleClass="ui-panelgrid-blank ui-fluid form-group removeSecondPadding"
							style="border:0px none; background-color:transparent;">

							<p:outputPanel>

								<p:panelGrid columns="3" layout="grid"
									styleClass="ui-panelgrid-blank ui-fluid form-group">

									<h:panelGroup>
										<h:outputText for="dataInicial" value="Data inicial:" />
										<p:calendar id="dataInicial"
											value="#{relatorioAtendimentoMB.dataInicio}" />
									</h:panelGroup>

									<h:panelGroup>
										<h:outputText for="dataFinal" value="Data final:" />
										<p:calendar id="dataFinal"
											value="#{relatorioAtendimentoMB.dataFim}" />
									</h:panelGroup>

									<h:panelGroup>
										<h:outputText for="filtroPaciente" value="Paciente:" />
										<p:autoComplete id="filtroPaciente"
											value="#{relatorioAtendimentoMB.filtroPorPaciente}"
											completeMethod="#{relatorioAtendimentoMB.sugestoesPacientes}"
											var="p" itemLabel="#{p.dadosBasico.nome}" itemValue="#{p}"
											converter="paciente" forceSelection="true" scrollHeight="400"
											minQueryLength="3" queryDelay="1000">

											<p:column headerText="Nome">
												<h:outputText value="#{p.dadosBasico.nome}" />
											</p:column>
											<p:column headerText="Celular">
												<h:outputText value="#{p.dadosBasico.celular}" />
											</p:column>
											<p:column headerText="Nome da Mãe">
												<h:outputText value="#{p.nomeMae}" />
											</p:column>

											<p:ajax event="itemSelect" process="@this" />
										</p:autoComplete>
									</h:panelGroup>

								</p:panelGrid>

								<p:panelGrid columns="3" layout="grid"
									styleClass="ui-panelgrid-blank ui-fluid form-group">

									<h:panelGroup>
										<h:outputText for="filtroProfissional" value="Profissional:" />
										<p:autoComplete id="filtroProfissional"
											value="#{relatorioAtendimentoMB.filtroPorProfissional}"
											completeMethod="#{relatorioAtendimentoMB.sugestoesProfissionais}"
											var="p" itemLabel="#{p.dadosBasico.nome}" itemValue="#{p}"
											converter="profissional" forceSelection="true"
											scrollHeight="400" queryDelay="1000">
											<p:ajax event="itemSelect" process="@this" />

										</p:autoComplete>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputText for="filtroProfissionalUltAlteracao"
											value="Ultima alteração realizada por:" />
										<p:autoComplete id="filtroProfissionalUltAlteracao"
											value="#{relatorioAtendimentoMB.filtroPorProfissionalUltAlteracao}"
											completeMethod="#{relatorioAtendimentoMB.sugestoesProfissionalUltAlteracao}"
											var="p" itemLabel="#{p.dadosBasico.nome}" itemValue="#{p}"
											converter="profissional" forceSelection="true"
											scrollHeight="400" queryDelay="1000">
											<p:ajax event="itemSelect" process="@this" />
										</p:autoComplete>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputText for="filtroConvenio" value="Convênio:" />
										<p:autoComplete id="filtroConvenio"
											value="#{relatorioAtendimentoMB.filtroPorConvenio}"
											completeMethod="#{relatorioAtendimentoMB.sugestoesConvenios}"
											var="p" itemLabel="#{p.dadosBasico.nome}" itemValue="#{p}"
											converter="convenio" forceSelection="true" scrollHeight="400"
											queryDelay="1000">
											<p:ajax event="itemSelect" process="@this" />
										</p:autoComplete>
									</h:panelGroup>

								</p:panelGrid>

							</p:outputPanel>

							<p:outputPanel id="pnFiltroStatus">

								<p:outputLabel value="Mostrar os agendamentos: " />

								<br />

								<h:panelGroup style="display:block;margin-left:3px;">
									<p:selectBooleanCheckbox id="checkFiltro"
										value="#{relatorioAtendimentoMB.checkFiltro}">
										<p:ajax event="change" process="@this"
											update=":lume:pnFiltroStatus"
											listener="#{relatorioAtendimentoMB.marcarFiltros}" />
									</p:selectBooleanCheckbox>
									<p:outputLabel for="checkFiltro" value="Marcar todos" />
								</h:panelGroup>

								<br />

								<p:selectManyCheckbox
									value="#{relatorioAtendimentoMB.filtroAtendimento}"
									layout="grid" columns="4" process="@this"
									update=":lume:filtroRelatorio">

									<p:ajax process="@this" />

									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoAfastamento legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Bloqueio&lt;/div&gt;"
										itemValue="F" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoAtendido legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Atendidos&lt;/div&gt;"
										itemValue="A" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoConsultaInicial legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Consulta Inicial&lt;/div&gt;"
										itemValue="G" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoCancelado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Cancelados&lt;/div&gt;"
										itemValue="C" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoErroAgendamento legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Erro de Agendamento&lt;/div&gt;"
										itemValue="D" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='clienteNaClinica legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Cliente na Clínica&lt;/div&gt;"
										itemValue="I" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoConfirmado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Confirmados&lt;/div&gt;"
										itemValue="S" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='emAtendimento legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Em Atendimento&lt;/div&gt;"
										itemValue="O" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoEncaixe legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Encaixe&lt;/div&gt;"
										itemValue="E" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoEncaixeAtendido legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Encaixe Atendido&lt;/div&gt;"
										itemValue="H" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoFalta legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Falta&lt;/div&gt;"
										itemValue="B" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoNaoConfirmado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Não Confirmado&lt;/div&gt;"
										itemValue="N" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoPrecadastro legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Agendado pelo Paciente&lt;/div&gt;"
										itemValue="P" itemEscaped="false" />
									<f:selectItem
										itemLabel="&lt;div&gt;&lt;div class='agendamentoRemarcado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Remarcado&lt;/div&gt;"
										itemValue="R" itemEscaped="false" />
								</p:selectManyCheckbox>

							</p:outputPanel>

							<p:outputPanel>

								<p:panelGrid columns="3" layout="grid"
									styleClass="ui-panelgrid-blank ui-fluid form-group">

									<h:panelGroup>
										<p:commandButton value="Filtrar"
											action="#{relatorioAtendimentoMB.popularLista}"
											icon="White fa fa-search"
											update=":lume:dtRelAtendimento,:lume:dlgGerarRelatorioTabela,:lume:filtroRelatorio"
											process="@this,:lume:filtroRelatorio" />
									</h:panelGroup>

									<h:panelGroup>
										<p:commandButton value="Imprimir"
											oncomplete="PF('dlgConfirmarImpCabecalho').show();"
											icon="White fa fa-print"
											update=":lume:dlgGerarRelatorioTabela,:lume:dlgConfirmarImpCabecalho"
											styleClass="RedButton"
											process="@this,:lume:dlgConfirmarImpCabecalho,:lume:filtroRelatorio"/>
									</h:panelGroup>
									<ui:remove>
									<h:panelGroup>
										<p:splitButton 	icon="White fa fa fa-file-excel-o" value="Exportar tabela para Excel" styleClass="GreenSplitButton"
														oncomplete="downloadArq();" process="dtRelAtendimento,@this" immediate="true">
											
											<p:menuitem	value="Exportar tabela para PDF" icon="fa fa fa-file-pdf-o" actionListener="#{relatorioAtendimentoMB.exportarTabela('pdf')}" ajax="false"
														process="dtRelAtendimento,@this" immediate="true">
												<p:fileDownload value="#{relatorioAtendimentoMB.arquivoDownload}"/>
											</p:menuitem>
															
										</p:splitButton>
									</h:panelGroup>
									
									<p:remoteCommand 	name="downloadArq" actionListener="#{relatorioAtendimentoMB.exportarTabela('xls')}" 
														process="dtRelAtendimento,@this" immediate="true">
														
										<p:fileDownload value="#{relatorioAtendimentoMB.arquivoDownload}" contentDisposition="attachment"/>
									</p:remoteCommand>
									</ui:remove>
									
								</p:panelGrid>

							</p:outputPanel>

						</p:panelGrid>
					</p:outputPanel>
					</p:fieldset>

					<h:panelGroup>
					
						<p:dataTable id="dtRelAtendimento" widgetVar="dtRelAtendimento"
							value="#{relatorioAtendimentoMB.listaAtendimentos}"
							var="atendimento" rowKey="#{atendimento}" rows="10"
							paginator="true" paginatorPosition="bottom" reflow="true"
							emptyMessage="Nenhum registro encontrado" binding="#{relatorioAtendimentoMB.tabelaAgendamento}"
							selection="#{relatorioAtendimentoMB.entity}"
							selectionMode="single" filterDelay="1000">

							<f:facet name="header">Relatório de atendimentos
							</f:facet>

							<p:column 	filterBy="#{atendimento.paciente.dadosBasico.nome}"
										sortBy="#{atendimento.paciente.dadosBasico.nome}"
										filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								 		headerText="Paciente">
								<h:outputText value="#{atendimento.paciente.dadosBasico.nome}" />
							</p:column>

							<p:column filterBy="#{atendimento.paciente.dadosBasico.celular}"
								sortBy="#{atendimento.paciente.dadosBasico.celular}"
								filterMatchMode="contains" headerText="Celular">
								<h:outputText
									value="#{atendimento.paciente.dadosBasico.celular}" />
							</p:column>

							<p:column filterBy="#{atendimento.paciente.dadosBasico.telefone}"
								sortBy="#{atendimento.paciente.dadosBasico.telefone}"
								filterMatchMode="contains" headerText="Telefone">
								<h:outputText
									value="#{atendimento.paciente.dadosBasico.telefone}" />
							</p:column>

							<p:column
								filterBy="#{atendimento.paciente.convenio.dadosBasico.nome}"
								sortBy="#{atendimento.paciente.convenio.dadosBasico.nome}"
								filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								filterMatchMode="contains" headerText="Convênio">
								<h:outputText
									value="#{atendimento.paciente.convenio.dadosBasico.nome}" />
							</p:column>

							<p:column filterBy="#{atendimento.profissional.dadosBasico.nome}"
								sortBy="#{atendimento.profissional.dadosBasico.nome}"
								filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								filterMatchMode="contains" headerText="Profissional responsável">
								<h:outputText
									value="#{atendimento.profissional.dadosBasico.nome}" />
							</p:column>

							<p:column filterBy="#{atendimento.dataUltAlteracao}"
								sortBy="#{atendimento.dataUltAlteracao}"
								filterMatchMode="contains" headerText="Data última alteração">
								<h:outputText
									value="#{relatorioAtendimentoMB.formatarData(atendimento.dataUltAlteracao)}" />
							</p:column>

							<p:column
								filterBy="#{atendimento.profissionalUltAlteracao.dadosBasico.nome}"
								sortBy="#{atendimento.profissionalUltAlteracao.dadosBasico.nome}"
								filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								filterMatchMode="contains"
								headerText="Última alteração realizada por">
								<h:outputText
									value="#{atendimento.profissionalUltAlteracao.dadosBasico.nome}" />
							</p:column>

							<p:column
								filterBy="#{atendimento.finalidadeAgendamento.descricao}"
								sortBy="#{atendimento.finalidadeAgendamento.descricao}"
								filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								filterMatchMode="contains" headerText="Consulta inicial">
								<h:outputText
									value="#{atendimento.finalidadeAgendamento.descricao}" />
							</p:column>

							<p:column filterBy="#{atendimento.inicio}"
								sortBy="#{atendimento.inicio}" filterMatchMode="contains"
								headerText="Data agendada">
								<h:outputText
									value="#{relatorioAtendimentoMB.formatarData(atendimento.inicio)}" />
							</p:column>

							<p:column
								filterBy="#{relatorioAtendimentoMB.getStatusDescricao(atendimento)}"
								sortBy="#{relatorioAtendimentoMB.getStatusDescricao(atendimento)}"
								filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								filterMatchMode="contains" headerText="Status do agendamento">
								<h:outputText
									value="#{relatorioAtendimentoMB.getStatusDescricao(atendimento)}" />
							</p:column>

							<p:column
								filterBy="#{atendimento.proximoAgendamentoPaciente.inicio}"
								sortBy="#{atendimento.proximoAgendamentoPaciente.inicio}"
								filterMatchMode="contains"
								headerText="Data do agendamento futuro">
								<p:commandButton id="btnNovoAgendamento"
									rendered="#{relatorioAtendimentoMB.verificarStatusAgendamentoFuturo(atendimento)}"
									action="#{agendamentoMB.popularAgendamento(atendimento)}"
									icon="fa fa fa-calendar" process="@this"
									oncomplete="PF('dlgAgendamento').show();"
									update=":lume:pnAgendamento">
									<p:ajax
										listener="#{relatorioAtendimentoMB.setNovoAgendamento(true)}" />
									<p:ajax
										listener="#{relatorioAtendimentoMB.verificarNovoAgendamento()}" />
								</p:commandButton>
								<p:tooltip for="btnNovoAgendamento" value="Agendar" />
								<h:outputText
									value="#{relatorioAtendimentoMB.formatarData(atendimento.proximoAgendamentoPaciente.inicio)}" />
							</p:column>

							<p:column
								filterBy="#{relatorioAtendimentoMB.getStatusDescricao(atendimento.proximoAgendamentoPaciente)}"
								sortBy="#{relatorioAtendimentoMB.getStatusDescricao(atendimento.proximoAgendamentoPaciente)}"
								filterFunction="#{relatorioAtendimentoMB.filtroSemAcento}"
								filterMatchMode="contains"
								headerText="Status do agendamento futuro">
								<h:outputText
									value="#{relatorioAtendimentoMB.getStatusDescricao(atendimento.proximoAgendamentoPaciente)}" />
							</p:column>

							<p:column>
								<p:commandButton id="btnView" icon="White fa fa-eye"
									oncomplete="PF('dlgAgendamento').show();"
									update=":lume:dlgGerarRelatorio,:lume:pnAgendamento" width="5%"
									action="#{agendamentoMB.setEntity(atendimento)}"
									process="@this">
									<p:ajax
										listener="#{relatorioAtendimentoMB.verificarNovoAgendamento()}" />
									<p:ajax
										listener="#{relatorioAtendimentoMB.setEntity(atendimento)}" />
									<p:ajax
										listener="#{relatorioAtendimentoMB.setNovoAgendamento(false)}" />
									<p:ajax
										listener="#{agendamentoMB.popularAgendamento(atendimento)}" />
									<p:tooltip for="btnView" value="Visualizar" />
								</p:commandButton>

								<p:button id="whats" icon="White fa fa-whatsapp"
									onclick="window.open('#{atendimento.paciente.whatsURL}');return false;"
									styleClass="GreenButton"
									disable="#{atendimento.paciente.whatsURL == null}" />
								<p:tooltip for="whats" value="Enviar mensagem" />
								
							</p:column>

						</p:dataTable>
					
					</h:panelGroup>

					<p:dialog id="dlgGerarRelatorio" widgetVar="dlgGerarRelatorio"
						header="Relatório" responsive="true" modal="true"
						onHide="PF('dlgGerarRelatorio').toggleMaximize();"
						onShow="PF('dlgGerarRelatorio').toggleMaximize();">

						<p:panel>
							<p:outputPanel id="relatorioAgendamento">

								<h1 style="font-size: 20px !important;" align="center">
									<h:outputText value="RELATÓRIO" />
								</h1>

								<div class="SeparatorFull"></div>

								<br />

								<h1
									style="font-size: 18px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
									<h:outputText value="#{relatorioAtendimentoMB.nomeClinica()}" />
								</h1>

								<h1
									style="font-size: 14px !important; margin: 0; margin-top: -5px; margin-bottom: 5px;">
									<h:outputText
										value="#{relatorioAtendimentoMB.telefoneClinica()}" />
								</h1>

								<br />

								<div class="SeparatorFull"></div>
								<br />

								<table style="width: 100%" class="firstRowBold">

									<tr
										style="text-align: left; font-weight: bold; margin-top: 20px !important;">

										<h2
											style="text-align: left; font-size: 16px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
											AGENDAMENTO</h2>

										<th>Agendado por:</th>
										<th>Data do agendamento:</th>
										<th>Status do agendamento:</th>

									</tr>

									<tr style="text-align: left; font-size: 14px !important;">

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.agendador.dadosBasico.nome}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.formatarData(relatorioAtendimentoMB.entity.inicio)}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.getStatusDescricao(relatorioAtendimentoMB.entity)}" />
										</td>

									</tr>

									<tr
										style="text-align: left; font-weight: bold; margin-top: 20px !important;">

										<th>Origem do agendamento:</th>
										<th>Finalidade do agendamento:</th>
										<th>Última alteração realizada por:</th>

									</tr>

									<tr style="text-align: left; font-size: 14px !important;">

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.origemAgendamento.descricao}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.finalidadeAgendamento.descricao}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.profissionalUltAlteracao.dadosBasico.nome}" />
										</td>

									</tr>
								</table>

								<div class="SeparatorFull"
									style="margin-bottom: 40px !important; margin-top: 40px !important;"></div>

								<table style="width: 100%" class="firstRowBold">
									<tr
										style="text-align: left; font-weight: bold; margin-top: 20px !important;">

										<h2
											style="text-align: left; font-size: 16px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
											DADOS PACIENTE</h2>

										<th>Paciente:</th>
										<th>Profissional responsável:</th>
										<th>Convênio:</th>

									</tr>

									<tr style="text-align: left; font-size: 14px !important;">

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.paciente.dadosBasico.nome}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.profissional.dadosBasico.nome}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.paciente.convenio.dadosBasico.nome}" />
										</td>

									</tr>

									<tr
										style="text-align: left; font-weight: bold; margin-top: 20px !important;">

										<th>Titular:</th>
										<th>Plano:</th>
										<th>Data da última alteração:</th>

									</tr>

									<tr style="text-align: left; font-size: 14px !important;">

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.paciente.titular.dadosBasico.nome}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.paciente.plano.nome}" />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.formatarData(relatorioAtendimentoMB.entity.paciente.dataUltimaAlteracao)}" />
										</td>

									</tr>
								</table>

								<div class="SeparatorFull"
									style="margin-bottom: 40px !important; margin-top: 40px !important;"></div>

								<table style="width: 100%" class="firstRowBold">
									<tr style="text-align: left; font-weight: normal;">

										<h2
											style="text-align: left; font-size: 16px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
											PLANO DE TRATAMENTO</h2>

										<th>Início do tratamento:</th>
										<th>Término do tratamento:</th>
										<th>Valor total:</th>

									</tr>

									<tr style="text-align: left; font-size: 14px !important;">

										<td><h:outputText
												value="#{relatorioAtendimentoMB.formatarData(relatorioAtendimentoMB.entity.planoTratamento.inicio)}" /><br />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.formatarData(relatorioAtendimentoMB.entity.planoTratamento.fim)}" /><br />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.planoTratamento.valorTotal}" /><br />
										</td>

									</tr>

									<tr
										style="text-align: left; font-weight: bold; margin-top: 20px !important;">

										<th>Valor total do desconto:</th>
										<th>Plano:</th>

									</tr>

									<tr style="text-align: left; font-size: 14px !important;">

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.planoTratamento.valorTotalDesconto}" /><br />
										</td>

										<td><h:outputText
												value="#{relatorioAtendimentoMB.entity.paciente.plano.nome}" /><br />
										</td>

									</tr>

								</table>

								<br />
							</p:outputPanel>
						</p:panel>

					</p:dialog>

					<p:dialog widgetVar="dlgAgendamento" header="Agendamento"
						resizable="false" id="pnAgendamento" responsive="true"
						modal="true" appendTo=":lume"
						onHide="PF('dlgAgendamento').toggleMaximize();"
						onShow="PF('dlgAgendamento').toggleMaximize();">

						<p:outputPanel id="pnDlgAgendamento"
							style="max-height: calc(100% - 54px); height: calc(100% - 54px);">
							<p:scrollPanel mode="native"
								style="position: relative; width: calc(100% - 20px); height: calc(100% - 20px); padding: 10px;">
								<ui:include src="dlgagendamento.xhtml" />
							</p:scrollPanel>
						</p:outputPanel>

						<p:panelGrid columns="3" layout="grid"
							styleClass="ui-panelgrid-blank form-group ui-fluid removeSideGridPadding">

							<h:panelGroup
								rendered="#{(agendamentoMB.habilitaSalvar) and (relatorioAtendimentoMB.novoAgendamento)}">
								<p:commandButton id="persist" icon="White fa fa-save"
									process="pnAgendamento" value="Salvar"
									actionListener="#{agendamentoMB.actionPersist}"
									styleClass="GreenButton"
									update=":lume:dtRelAtendimento,:lume:filtroRelatorio" />
							</h:panelGroup>

							<p:commandButton id="imprimirRelatorio" icon="White fa fa-print"
								value="Imprimir"
								rendered="#{!relatorioAtendimentoMB.novoAgendamento}"
								styleClass="RedButton" process="@this,:lume:dlgGerarRelatorio"
								update=":lume:dlgGerarRelatorio">
								<p:printer target="relatorioAgendamento" />
							</p:commandButton>

							<p:commandButton icon="White fa fa-close" value="Fechar"
								process="@this"
								update=":lume:dtRelAtendimento,:lume:filtroRelatorio"
								onclick="PF('dlgAgendamento').hide()" />
						</p:panelGrid>
					</p:dialog>

					<p:dialog id="dlgConfirmarImpCabecalho"
						widgetVar="dlgConfirmarImpCabecalho" responsive="true"
						icon="pi pi-exclamation-triangle" width="300px" modal="true"
						draggable="false" blockScroll="true" positionTop="0"
						positionLeft="0" style="overflow:hidden !important;">

						<h:panelGroup style="margin:16px;">
							<p:selectBooleanCheckbox id="cabecalho"
								value="#{relatorioAtendimentoMB.imprimirCabecalho}">
								<p:ajax event="change" update=":lume:dlgGerarRelatorioTabela" />
							</p:selectBooleanCheckbox>
							<p:outputLabel for="cabecalho" value="Imprimir cabeçalho" />
						</h:panelGroup>

						<p:panelGrid columns="2" layout="grid"
							styleClass="ui-panelgrid-blank ui-fluid form-group">

							<h:panelGroup>
								<p:commandButton value="Fechar"
									oncomplete="PF('dlgConfirmarImpCabecalho').hide();" />
							</h:panelGroup>

							<h:panelGroup>
								<p:commandButton value="Confirmar" onstart="imprimirTabela();"
									oncomplete="PF('dlgConfirmarImpCabecalho').hide();" />
							</h:panelGroup>

						</p:panelGrid>

					</p:dialog>

					<p:dialog id="dlgGerarRelatorioTabela"
						widgetVar="dlgGerarRelatorioTabela" header="Relatório"
						responsive="true" modal="true">

						<div class="table">
							<p:outputPanel id="relatorioTabela">

								<h1 style="font-size: 20px !important;">
									<h:outputText value="RELATÓRIO" />
								</h1>

								<br />

								<h1
									style="font-size: 16px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
									<h:outputText value="#{relatorioAtendimentoMB.nomeClinica()}" />
								</h1>

								<h1
									style="font-size: 14px !important; margin: 0; margin-top: -5px; margin-bottom: 5px;">
									<h:outputText
										value="#{relatorioAtendimentoMB.telefoneClinica()}" />
								</h1>

								<p:outputPanel
									rendered="#{relatorioAtendimentoMB.imprimirCabecalho}">

									<br />

									<table style="width: 100%; font-size: 12px;"
										class="firstRowBold">

										<tr
											style="text-align: left; font-weight: bold; margin-top: 20px !important;">

											<h2
												style="text-align: left; font-size: 14px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
												ATENDIMENTO</h2>

											<th>Data inicial:</th>
											<th>Data final:</th>
											<th>Paciente:</th>

										</tr>

										<tr style="text-align: left;">

											<td><h:outputText
													value="#{relatorioAtendimentoMB.formatarData(relatorioAtendimentoMB.dataInicio)}" />
											</td>

											<td><h:outputText
													value="#{relatorioAtendimentoMB.formatarData(relatorioAtendimentoMB.dataFim)}" />
											</td>

											<td><h:outputText
													value="#{relatorioAtendimentoMB.filtroPorPaciente.dadosBasico.nome}" />
											</td>

										</tr>

										<tr
											style="text-align: left; font-weight: bold; margin-top: 20px !important;">

											<th>Profissional:</th>
											<th>Última alteração realizada por:</th>
											<th>Convênio:</th>

										</tr>

										<tr style="text-align: left; font-size: 14px !important;">

											<td><h:outputText
													value="#{relatorioAtendimentoMB.filtroPorProfissional.dadosBasico.nome}" />
											</td>

											<td><h:outputText
													value="#{relatorioAtendimentoMB.filtroPorProfissionalUltAlteracao.dadosBasico.nome}" />
											</td>

											<td><h:outputText
													value="#{relatorioAtendimentoMB.filtroPorConvenio.dadosBasico.nome}" />
											</td>

										</tr>
									</table>

									<br />

									<h2
										style="text-align: left; font-size: 14px !important; margin: 0; margin-top: 10px; margin-bottom: 10px; font-weight: bold;">
										AGENDAMENTOS</h2>

									<p:selectManyCheckbox
										value="#{relatorioAtendimentoMB.filtroAtendimento}"
										style="font-size:12px !important;" layout="grid" columns="4">

										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoAfastamento legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Bloqueio&lt;/div&gt;"
											itemValue="F" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoAtendido legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Atendidos&lt;/div&gt;"
											itemValue="A" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoConsultaInicial legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Consulta Inicial&lt;/div&gt;"
											itemValue="G" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoCancelado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Cancelados&lt;/div&gt;"
											itemValue="C" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoErroAgendamento legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Erro de Agendamento&lt;/div&gt;"
											itemValue="D" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='clienteNaClinica legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Cliente na Clínica&lt;/div&gt;"
											itemValue="I" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoConfirmado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Confirmados&lt;/div&gt;"
											itemValue="S" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='emAtendimento legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Em Atendimento&lt;/div&gt;"
											itemValue="O" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoEncaixe legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Encaixe&lt;/div&gt;"
											itemValue="E" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoEncaixeAtendido legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Encaixe Atendido&lt;/div&gt;"
											itemValue="H" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoFalta legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Falta&lt;/div&gt;"
											itemValue="B" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoNaoConfirmado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Não Confirmado&lt;/div&gt;"
											itemValue="N" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoPrecadastro legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Agendado pelo Paciente&lt;/div&gt;"
											itemValue="P" itemEscaped="false" />
										<f:selectItem
											itemLabel="&lt;div&gt;&lt;div class='agendamentoRemarcado legendaFiltroAgendamento'&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;Remarcado&lt;/div&gt;"
											itemValue="R" itemEscaped="false" />
									</p:selectManyCheckbox>

								</p:outputPanel>

								<br />

								<table style="width: 100%; font-size: 10px; text-align: left;">

									<tr style="text-align: center; margin: 5px;">
										<th style="border: 1px solid;">Paciente</th>
										<th style="border: 1px solid;">Celular</th>
										<th style="border: 1px solid;">Telefone</th>
										<th style="border: 1px solid;">Convênio</th>
										<th style="border: 1px solid;">Profissional responsável</th>
										<th style="border: 1px solid;">Origem do agendamento</th>
										<th style="border: 1px solid;">Data do agendamento</th>
										<th style="border: 1px solid;">Satus do agendamento</th>
										<th style="border: 1px solid;">Data do próximo
											agendamento</th>
										<th style="border: 1px solid;">Status do próximo
											agendamento</th>
									</tr>

									<c:forEach var="atendimento"
										items="#{relatorioAtendimentoMB.listaAtendimentos}">
										<tr>
											<td><h:outputText
													value="#{atendimento.paciente.dadosBasico.nome}" /></td>
											<td><h:outputText
													value="#{atendimento.paciente.dadosBasico.celular}" /></td>
											<td><h:outputText
													value="#{atendimento.paciente.dadosBasico.telefone}" /></td>
											<td><h:outputText
													value="#{atendimento.paciente.convenio.dadosBasico.nome}" />
											</td>
											<td><h:outputText
													value="#{atendimento.profissional.dadosBasico.nome}" /></td>
											<td><h:outputText
													value="#{atendimento.origemAgendamento.descricao}" /></td>
											<td><h:outputText
													value="#{relatorioAtendimentoMB.formatarData(atendimento.inicio)}" />
											</td>
											<td><h:outputText
													value="#{relatorioAtendimentoMB.getStatusDescricao(atendimento)}" />
											</td>
											<td><h:outputText
													value="#{relatorioAtendimentoMB.formatarData(atendimento.proximoAgendamentoPaciente.dataAgendamento)}" />
											</td>
											<td><h:outputText
													value="#{relatorioAtendimentoMB.getStatusDescricao(atendimento.proximoAgendamentoPaciente)}" />
											</td>
										</tr>
									</c:forEach>

								</table>

								<br />
							</p:outputPanel>
						</div>

					</p:dialog>

				</div>
			</div>
		</div>
		<script type="text/javascript">
			//<![CDATA[
			function handleDialogRequest(xhr, status, args) {
				console.debug('handleDialogRequest');
				console.debug(args);
				if (args.dlg == true) {
					PF('eventDialog').hide();
				} else {
					window.scrollTo(0, 0);
				}
			}

			function imprimirTabela() {
				var toPrint = document.getElementById("lume:relatorioTabela");
				var newWin = window.open("");
				newWin.visible = false;
				newWin.document
						.write("<style type=\"text/css\" media=\"print\"> @page { size: landscape; }"
								+ ".ui-selectmanycheckbox tr td {position: relative;	display: inline-flex !important;width: 238px !important;}"
								+ ".ui-selectmanycheckbox tr td>div>div:last-child {display: inline-block;position: relative;top: 50%;transform: translateY(-50%);}"
								+ ".ui-selectmanycheckbox tr td label {position: relative;display: inline-flex !important;}"
								+ ".ui-selectmanycheckbox tr td label div:first-child {position: relative;}"
								+ ".ui-selectmanycheckbox tr td label div:first-child div {display: inline-block;position: relative;top: 50%;transform: translateY(-50%);}</style>")

				newWin.document.write(toPrint.outerHTML);
				newWin.document.close();

				newWin.print();
				newWin.close();

			}

			//]]>
		</script>
	</ui:define>
</ui:composition>
