<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<style>
.optionsPaciente .ui-panelgrid-cell {
	padding: 12px 8px !important;
}
</style>
	<div class="ui-g ui-fluid">
		<div class="ui-g-12 ui-lg-12">
			<p:panelGrid columns="2" columnClasses="ui-grid-col-2,ui-grid-col-10"
				layout="grid" styleClass="ui-panelgrid-blank"
				style="border:0px none; background-color:transparent;">

				<h:panelGroup id="foto">
					<div class="Container100">
						<p:graphicImage styleClass="Fleft"
							value="#{pacienteMB.imagemUsuario}" stream="false"
							style="width:100%;"
							rendered="#{pacienteMB.imagemUsuario != null}" />
						<h:graphicImage name="sem-imagem-avatar.png" styleClass="Fleft"
							style="width:100%;" library="images"
							rendered="#{pacienteMB.imagemUsuario == null}" />
					</div>
				</h:panelGroup>
				<p:fieldset legend="Dados Pessoais" toggleable="true"
					collapsed="false">

					<p:panelGrid columns="4"
						columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
						layout="grid" styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">

						<p:outputLabel for="nome" value="Nome : " />
						<p:inputText id="nome"
							value="#{pacienteMB.entity.dadosBasico.nome}" required="true"
							maxlength="200" />

						<p:outputLabel for="nomePreferencial" value="Nome Preferencial : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="nomePreferencial"
							value="#{pacienteMB.entity.dadosBasico.nomePreferencial}"
							maxlength="200" rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="nomeMae" value="Nome da Mãe : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="nomeMae" value="#{pacienteMB.entity.nomeMae}"
							maxlength="200" rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="email" value="E-Mail : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="email"
							value="#{pacienteMB.entity.dadosBasico.email}" maxlength="200"
							rendered="#{pacienteMB.visivelDadosPaciente}" required="false">
						</p:inputText>

						<p:outputLabel id="lblDocumento" for="documento" value="CPF : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputMask id="documento" required="false"
							validatorMessage="CPF inválido"
							value="#{pacienteMB.entity.dadosBasico.documento}"
							mask="999.999.999-99"
							rendered="#{pacienteMB.visivelDadosPaciente}">
							<f:validator validatorId="documentoValidator" />
						</p:inputMask>

						<p:outputLabel for="rg" value="RG : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="rg" value="#{pacienteMB.entity.dadosBasico.rg}"
							maxlength="12" rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="cep" value="CEP : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<h:panelGroup style="display: flex !important;"
							rendered="#{pacienteMB.visivelDadosPaciente}">
							<p:inputMask id="cep"
								value="#{pacienteMB.entity.dadosBasico.cep}" maxlength="8"
								mask="99999-999">
								<f:validator validatorId="cepValidator" />
							</p:inputMask>
							<p:commandButton id="cepsearch" icon="White fa fa-search White"
								actionListener="#{pacienteMB.actionBuscaCep}"
								update=":lume:endereco,:lume:bairro,:lume:cidade,:lume:estado"
								process="@this,:lume:cep" />
						</h:panelGroup>

						<p:outputLabel for="endereco" value="Endereço : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="endereco"
							value="#{pacienteMB.entity.dadosBasico.endereco}" maxlength="200"
							rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="numero" value="Número : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="numero"
							value="#{pacienteMB.entity.dadosBasico.numero}" maxlength="6"
							rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="bairro" value="Bairro : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="bairro"
							value="#{pacienteMB.entity.dadosBasico.bairro}" maxlength="200"
							rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="complemento" value="Complemento : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="complemento"
							value="#{pacienteMB.entity.dadosBasico.complemento}"
							maxlength="100" rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="cidade" value="Cidade : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="cidade"
							value="#{pacienteMB.entity.dadosBasico.cidade}" maxlength="200"
							rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="estado" value="Estado : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:selectOneMenu id="estado"
							value="#{pacienteMB.entity.dadosBasico.uf}"
							rendered="#{pacienteMB.visivelDadosPaciente}">
							<f:selectItem itemValue="#{null}" itemLabel="Selecione um Estado" />
							<f:selectItems value="#{pacienteMB.listUF}" var="uf"
								itemValue="#{uf}" itemLabel="#{uf.nome}" />
						</p:selectOneMenu>

						<p:outputLabel for="telResidencia" value="Telefone Residencial : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="telResidencia"
							value="#{pacienteMB.entity.dadosBasico.telefone}"
							onfocus="#{lumeSecurity.empresa.empBolRetirarMascaraTelefone == false ? 'mascaraTelefone()' : ''}"
							rendered="#{pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="telCelular" value="Celular : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<h:panelGroup style="display: flex !important;"
							rendered="#{pacienteMB.visivelDadosPaciente}">
							<p:inputText id="telCelular"
								value="#{pacienteMB.entity.dadosBasico.celular}"
								onfocus="#{lumeSecurity.empresa.empBolRetirarMascaraTelefone == false ? 'mascaraTelefone()' : ''}"
								required="true" />
							<p:button icon="White fa fa-whatsapp"
								disabled="#{pacienteMB.getUrlWpp(pacienteMB.entity) == null}"
								onclick="window.open('#{pacienteMB.getUrlWpp(pacienteMB.entity)}'); return false;"
								styleClass="GreenButton" />
						</h:panelGroup>

						<p:outputLabel for="dtNascimento" value="Data de Nascimento : " />
						<p:calendar id="dtNascimento"
							value="#{pacienteMB.entity.dadosBasico.dataNascimento}"
							pattern="dd/MM/yyyy" mask="true" showWeeksBar="false"
							locale="#{lumeSecurity.locale}"
							timeZone="#{lumeSecurity.timeZone}" navigator="true"
							yearRange="-100:+0" maxdate="#{odontoMB.sysdate}">
							<p:ajax event="dateSelect" update="lblResponsavel,lblDocumento"
								listener="#{pacienteMB.validaIdade}" />
						</p:calendar>

						<p:outputLabel for="sexo" value="Sexo : " />
						<p:selectOneRadio id="sexo"
							value="#{pacienteMB.entity.dadosBasico.sexo}">
							<f:selectItem itemLabel="Masculino" itemValue="M" />
							<f:selectItem itemLabel="Feminino" itemValue="F" />
						</p:selectOneRadio>

						<p:outputLabel for="particularidades" value="Particularidades : " />
						<p:inputTextarea id="particularidades" rows="3" cols="33"
							value="#{pacienteMB.entity.dadosBasico.particularidades}"
							maxlength="500" />

					</p:panelGrid>
				</p:fieldset>
			</p:panelGrid>


			<p:panelGrid columns="2" columnClasses="ui-grid-col-2,ui-grid-col-10"
				layout="grid" styleClass="ui-panelgrid-blank"
				style="border:0px none; background-color:transparent;">
				<p:column></p:column>
				<p:fieldset legend="Convênio" toggleable="true" collapsed="false">
					<p:panelGrid columns="4"
						columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
						layout="grid" styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">
						<p:outputLabel for="convenio" value="#{dominioMB.convenio} : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:selectOneMenu id="convenio"
							value="#{pacienteMB.entity.convenio}" converter="convenio"
							autoWidth="false" rendered="#{pacienteMB.visivelDadosPaciente}">
							<f:selectItem itemValue="#{null}"
								itemLabel="Sem #{dominioMB.convenio}" />
							<f:selectItems value="#{pacienteMB.convenios}" var="convenio"
								itemValue="#{convenio}" itemLabel="#{convenio.dadosBasico.nome}" />
						</p:selectOneMenu>

						<p:outputLabel id="lblnumeroPlano" for="numeroPlano"
							value="Carteira do Convênio : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="numeroPlano"
							value="#{pacienteMB.entity.numeroPlano}" maxlength="50"
							rendered="#{pacienteMB.visivelDadosPaciente}" />


						<p:outputLabel for="titular" value="Titular : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:autoComplete queryDelay="1000"
							value="#{pacienteMB.entity.titular}" id="titular"
							completeMethod="#{pacienteMB.geraSugestoesPaciente}" var="p"
							itemLabel="#{p.dadosBasico.nomeDocumento}" itemValue="#{p}"
							converter="paciente" size="46" forceSelection="true"
							scrollHeight="400" maxlength="200" minQueryLength="3"
							rendered="#{pacienteMB.visivelDadosPaciente}">
						</p:autoComplete>
					</p:panelGrid>
				</p:fieldset>
			</p:panelGrid>


			<p:panelGrid columns="2" columnClasses="ui-grid-col-2,ui-grid-col-10"
				layout="grid" styleClass="ui-panelgrid-blank"
				style="border:0px none; background-color:transparent;">
				<p:column></p:column>
				<p:fieldset legend="Responsável Legal" toggleable="true"
					collapsed="false">
					<p:panelGrid columns="4"
						columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
						layout="grid" styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">

						<p:outputLabel id="lblCPFResponsavel" for="cpfresponsavel"
							value="CPF do Responsável :" />
						<p:inputMask id="cpfresponsavel" required="false"
							validatorMessage="CPF inválido"
							value="#{pacienteMB.entity.dadosBasico.cpfresponsavel}"
							mask="999.999.999-99">
							<f:validator validatorId="documentoValidator"
								disabled="#{!pacienteMB.responsavel}" />
						</p:inputMask>

						<p:outputLabel id="lblResponsavel" for="responsavel"
							value="Nome do Responsável : " />
						<p:inputText id="responsavel" required="#{pacienteMB.responsavel}"
							value="#{pacienteMB.entity.dadosBasico.responsavel}"
							maxlength="100" />

						<p:outputLabel for="telefoneResponsavel"
							value="Telefone do Responsável : " />
						<p:inputText id="telefoneResponsavel"
							value="#{pacienteMB.entity.dadosBasico.telefoneResponsavel}"
							onfocus="#{lumeSecurity.empresa.empBolRetirarMascaraTelefone == false ? 'mascaraTelefone()' : ''}" />

					</p:panelGrid>
				</p:fieldset>
			</p:panelGrid>			
			<p:panelGrid columns="2" columnClasses="ui-grid-col-2,ui-grid-col-10"
				layout="grid" styleClass="ui-panelgrid-blank"
				style="border:0px none; background-color:transparent;">
				<p:column></p:column>
				<p:fieldset legend="Outros dados" toggleable="true"
					collapsed="false">
					
					<p:panelGrid columns="4"
						columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
						layout="grid" styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">

						<p:outputLabel for="indicacao" value="Como chegou na clínica: "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:selectOneMenu id="indicacao"
							value="#{pacienteMB.indicacao}" converter="dominio"
							autoWidth="false" rendered="#{pacienteMB.visivelDadosPaciente}">
							<f:selectItem itemValue="#{null}"
								itemLabel="Selecione" />
							<f:selectItems value="#{pacienteMB.indicacoes}" var="indicacao"
								itemValue="#{indicacao}" itemLabel="#{indicacao.nome}" />											
							<p:ajax event="itemSelect" process="@this" 
							update="legado,pnlPacAntigo" listener="#{pacienteMB.mudaIndicacao}"/>		
						</p:selectOneMenu>	
						</p:panelGrid>
			
					
					<p:panelGrid columns="4" id="pnlPacAntigo"
						columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
						layout="grid" styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">
					
						<p:outputLabel for="outros" value="Outros: " rendered="#{pacienteMB.showOutros()}"/>
						<p:inputText id="outros" rendered="#{pacienteMB.showOutros()}"
							value="#{pacienteMB.entity.indicacao}" required="false"
							maxlength="200" />	
						<p:outputLabel for="paciente" value="Selecione o Paciente que indicou: " rendered="#{pacienteMB.showPaciente()}"/>							
						<p:autoComplete dropdown="true" queryDelay="1000" rendered="#{pacienteMB.showPaciente()}"
							value="#{pacienteMB.entity.indicacaoPaciente}" id="paciente"
							minQueryLength="3" scrollHeight="400"
							completeMethod="#{pacienteMB.geraSugestoes}" var="p"
							itemLabel="#{p.dadosBasico.nome}" itemValue="#{p}"
							converter="paciente" forceSelection="true"						
							styleClass="paciente tallerAutoComplete">	
							<p:column headerText="Nome">
								<h:outputText value="#{p.dadosBasico.nome}" />
							</p:column>
							<p:column headerText="Celular">
								<h:outputText value="#{p.dadosBasico.celular}" />
							</p:column>
							<p:column headerText="Nome da Mãe">
								<h:outputText value="#{p.nomeMae}" />
							</p:column>
						</p:autoComplete>							
						
						<p:outputLabel for="profissionalIndicacao" value="Profissional" rendered="#{pacienteMB.showProfissional()}"/>
						<p:selectOneMenu id="profissionalIndicacao" styleClass="tallerCombo" rendered="#{pacienteMB.showProfissional()}"
							value="#{pacienteMB.entity.indicacaoProfissional}"
							converter="profissional" filter="true" filterMatchMode="contains">						
							<f:selectItem itemValue="#{null}"
								itemLabel="Selecione o profissional que indicou" />
							<f:selectItems value="#{pacienteMB.profissionais}"
								var="profissional"
								itemLabel="#{profissional.dadosBasico.prefixoNome}"
								itemValue="#{profissional}" />
						</p:selectOneMenu>	
					
					</p:panelGrid>
					<p:panelGrid columns="4" 
						columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
						layout="grid" styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">
						<p:outputLabel for="legado" value="Paciente antigo? : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<p:selectBooleanCheckbox id="legado"
							value="#{pacienteMB.entity.legado}"
							 />

						<p:outputLabel for="dataCriacao" value="Data Registro : "
							rendered="#{pacienteMB.entity.dataCriacao != null and pacienteMB.visivelDadosPaciente}" />
						<p:inputText id="dataCriacao"
							value="#{pacienteMB.entity.dataCriacaoStr}" readonly="true"
							rendered="#{pacienteMB.entity.dataCriacao != null and pacienteMB.visivelDadosPaciente}" />

						<p:outputLabel for="foto" value="Foto : "
							rendered="#{pacienteMB.visivelDadosPaciente}" />
						<h:panelGroup rendered="#{pacienteMB.visivelDadosPaciente}">
							<div class="Container70">
								<p:commandButton value="Tirar Foto" process="@this"
									update=":lume:pnTirarFoto" icon="White fa fa-camera"
									disabled="#{pacienteMB.entity.id == null}"
									styleClass="NavyButton" oncomplete="PF('dlgTirarFoto').show();"
									actionListener="#{pacienteMB.renderedPhotoCam}" />
							</div>
						</h:panelGroup>
					</p:panelGrid>					
				</p:fieldset>
			</p:panelGrid>
		</div>
	</div>

	<p:dialog id="dlgTirarFoto" header="Tirar Foto" appendTo=":lume"
		widgetVar="dlgTirarFoto" responsive="true" modal="true">
		<h:panelGroup id="pnTirarFoto">
			<div class="Container100 Responsive100 NoIndent">
				<div class="Container100 ui-fluid NoPadding">
					<div class="Container50 Responsive100">
						<p:commandButton value="Capturar" icon="White fa fa-camera"
							type="button" onclick="PF('pc').capture()"
							styleClass="NavyButton" />
					</div>
					<div class="Container50 Responsive100">
						<p:commandButton value="Salvar" icon="White fa fa-save"
							process="@this" styleClass="GreenButton"
							actionListener="#{pacienteMB.actionSalvarFoto}"
							oncomplete="PF('dlgTirarFoto').hide();" update=":lume:foto" />
					</div>
					<div class="SeparatorFull"></div>

					<p:panelGrid columns="2" layout="grid"
						styleClass="ui-panelgrid-blank"
						style="border:0px none; background-color:transparent;">
						<p:photoCam widgetVar="pc" listener="#{pacienteMB.onCapture}"
							update="photoPaciente" rendered="#{pacienteMB.renderedPhotoCam}" />
						<p:outputPanel id="photoPaciente">
							<p:graphicImage value="#{pacienteMB.scFoto}" stream="false" />
						</p:outputPanel>
					</p:panelGrid>

				</div>
			</div>
		</h:panelGroup>
	</p:dialog>

</ui:composition>